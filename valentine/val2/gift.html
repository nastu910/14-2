<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=yes">
    <title>Valentine Gift</title>

    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@400;600&family=Montserrat:wght@300;400&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        :root {
            --primary-red: #c0392b;
            --dark-text: #641e16;
            --gold: #f1c40f;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Quicksand', sans-serif;
            background: radial-gradient(circle at center, #fff0f0 0%, #ffdde1 40%, #ee9ca7 100%);
            color: var(--dark-text);
            transition: background 2s ease;
            width: 100vw;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
        }

        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            visibility: hidden;
            opacity: 0;
            text-align: center;
            padding: 20px;
            z-index: 20;
        }

        .active {
            visibility: visible;
            opacity: 1;
        }

        .handwriting {
            font-family: 'Dancing Script', cursive;
        }

        /* --- BUTTON STYLE --- */
        .btn-premium {
            background: linear-gradient(135deg, #c0392b, #8e44ad);
            padding: 12px 40px;
            border-radius: 50px;
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(142, 68, 173, 0.4);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            margin-top: 25px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            z-index: 50;
            position: relative;
            letter-spacing: 1px;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-premium:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 25px rgba(192, 57, 43, 0.6);
        }

        /* --- MUSIC PLAYER --- */
        .music-player {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 200;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 10px 15px;
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .music-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #c0392b;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            width: 30px;
            height: 30px;
            padding: 0;
        }

        .music-btn svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .music-info {
            font-size: 0.8rem;
            font-weight: bold;
            color: #922b21;
            max-width: 0;
            overflow: hidden;
            white-space: nowrap;
            transition: max-width 0.5s;
            opacity: 0;
        }

        .music-player:hover .music-info,
        .music-player:active .music-info {
            max-width: 150px;
            opacity: 1;
            margin-right: 10px;
        }

        /* --- H·ªòP QU√Ä --- */
        .gift-container {
            position: relative;
            width: 140px;
            height: 120px;
            cursor: pointer;
            margin-bottom: 30px;
            z-index: 30;
            transition: transform 0.3s;
        }

        .gift-box {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: #c0392b;
            border-radius: 4px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            transition: opacity 0.5s ease-in-out 0.5s;
        }

        .gift-lid {
            position: absolute;
            top: 0;
            left: -10px;
            width: 160px;
            height: 30px;
            background: #e74c3c;
            border-radius: 4px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            z-index: 2;
            transition: transform 1s ease-in-out, opacity 0.8s ease-in-out 0.2s;
        }

        .ribbon-body,
        .ribbon-lid {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 24px;
            height: 100%;
            background: #f1c40f;
            border-left: 2px solid #f39c12;
            border-right: 2px solid #f39c12;
        }

        .gift-bow {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 30px;
            z-index: 3;
            transition: transform 1s ease-in-out, opacity 0.8s ease-in-out 0.2s;
        }

        .gift-bow::before,
        .gift-bow::after {
            content: '';
            position: absolute;
            bottom: 0;
            width: 30px;
            height: 35px;
            border: 4px solid #f1c40f;
            border-radius: 50% 50% 0 50%;
            background: radial-gradient(circle at center, transparent 40%, #f1c40f 41%);
        }

        .gift-bow::before {
            left: -15px;
            transform: rotate(10deg);
        }

        .gift-bow::after {
            right: -15px;
            transform: rotate(-10deg) scaleX(-1);
        }

        @keyframes shakeBox {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(3deg); }
            75% { transform: rotate(-3deg); }
        }

        .animate-shake {
            animation: shakeBox 2s infinite ease-in-out;
        }

        .gift-container:hover {
            transform: scale(1.05);
        }

        .gift-container.opening {
            animation: none;
            pointer-events: none;
        }

        .gift-container.opening .gift-lid,
        .gift-container.opening .gift-bow {
            transform: translateY(-120px) rotate(-15deg);
            opacity: 0;
        }

        .gift-container.opening .gift-box {
            opacity: 0;
        }

        /* --- HOA R∆†I --- */
        .falling-flower {
            position: fixed;
            pointer-events: none;
            z-index: 5;
            opacity: 0.9;
            top: -50px;
        }

        #final-msg-container {
            display: none;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transition: opacity 1s ease;
            position: relative;
            z-index: 60;
        }
    </style>
</head>

<body>

    <div class="music-player">
        <div class="music-info" id="musicTitle">MUSIC</div>
        <button class="music-btn" onclick="prevSong()" title="L√πi l·∫°i">
            <svg viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z" /></svg>
        </button>
        <button class="music-btn" id="playPauseBtn" onclick="togglePlay()" title="Ph√°t/D·ª´ng">
            <svg id="playIcon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z" /></svg>
            <svg id="pauseIcon" viewBox="0 0 24 24" style="display: none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" /></svg>
        </button>
        <button class="music-btn" onclick="nextSong()" title="Ti·∫øp theo">
            <svg viewBox="0 0 24 24"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z" /></svg>
        </button>
    </div>

    <audio id="bgMusic">
        <source src="" type="audio/mpeg">
    </audio>

    <section id="screen1" class="screen active">
        <h2 class="text-4xl md:text-6xl mb-6 handwriting" style="color: #922b21; text-shadow: 2px 2px 4px rgba(255,255,255,0.4);">ÏïàÎÖïÌïòÏÑ∏Ïöî üå∏</h2>
        <p class="text-xl md:text-2xl mb-8 font-medium" style="color: #7b241c;">M·ªôt m√≥n qu√† kh√°c c≈©ng c√≥ ch√∫t gi·ªëng c√°i kia, nh∆∞ng l√† ver 2</p>
        <button class="btn-premium" onclick="startExperience()">M·ªû QU√Ä NGAY üéÅ</button>
    </section>

    <section id="screen2" class="screen">
        <div id="giftBox" class="gift-container animate-shake">
            <div class="gift-bow"></div>
            <div class="gift-lid"><div class="ribbon-lid"></div></div>
            <div class="gift-box"><div class="ribbon-body"></div></div>
        </div>
        
        <h2 id="giftText" class="text-2xl handwriting font-bold text-red-800 mt-5 transition-opacity duration-500">Click v√†o h·ªôp qu√† ƒë·ªÉ m·ªü</h2>
        
        <canvas id="heartCanvas" width="800" height="400" class="hidden" style="max-width: 95vw; height: auto; margin-top: -50px;"></canvas>
        
        <div id="final-msg-container" class="mt-4">
            <h1 class="handwriting text-5xl text-red-600 mb-2 font-bold drop-shadow-md">Happy Valentine's Day!</h1>
            <p class="text-lg text-red-800 mb-6 italic">Valentine vui v·∫ª ‚ù§Ô∏è</p>
        </div>
    </section>

    <script>
        // ===========================================
        // 1. QU·∫¢N L√ù NH·∫†C
        // ===========================================
        const playlist = [
            { title: "Just Say Hello", src: "Just_Say_Hello.mp3" },
            { title: "Stuck With U", src: "Stuck_With_U.mp3" },
            { title: "Baby You Are My Light", src: "Baby_You_Are_My_Light.mp3" }
        ];

        let currentSongIndex = 0;
        const audio = document.getElementById('bgMusic');
        audio.addEventListener('ended', nextSong);
        const playIcon = document.getElementById('playIcon');
        const pauseIcon = document.getElementById('pauseIcon');
        const musicTitle = document.getElementById('musicTitle');
        let isPlaying = false;

        audio.src = playlist[currentSongIndex].src;
        musicTitle.innerText = playlist[currentSongIndex].title;

        function togglePlay() {
            if (isPlaying) {
                audio.pause();
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
            } else {
                audio.play();
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
            }
            isPlaying = !isPlaying;
        }

        function nextSong() {
            currentSongIndex = (currentSongIndex + 1) % playlist.length;
            loadAndPlaySong();
        }

        function prevSong() {
            currentSongIndex = (currentSongIndex - 1 + playlist.length) % playlist.length;
            loadAndPlaySong();
        }

        function loadAndPlaySong() {
            audio.src = playlist[currentSongIndex].src;
            musicTitle.innerText = playlist[currentSongIndex].title;
            if (isPlaying) audio.play();
        }

        function startExperience() {
            if (!isPlaying) togglePlay();
            nextPage(2);
        }

        // ===========================================
        // 2. CHUY·ªÇN TRANG
        // ===========================================
        function nextPage(pageNumber) {
            gsap.to(`.screen`, {
                opacity: 0,
                visibility: 'hidden',
                duration: 0.5
            });
            setTimeout(() => {
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                
                const nextScreen = document.getElementById(`screen${pageNumber}`);
                if (nextScreen) {
                    nextScreen.classList.add('active');
                    gsap.to(nextScreen, {
                        opacity: 1,
                        visibility: 'visible',
                        duration: 0.8
                    });
                    if (pageNumber === 2) initHeartAnimation();
                }
            }, 500);
        }

        // ===========================================
        // 3. HI·ªÜU ·ª®NG HOA R∆†I (VALENTINE STYLE)
        // ===========================================
        function createFlower() {
            const flower = document.createElement('div');
            flower.className = 'falling-flower';
            const size = Math.random() * 15 + 15;
            flower.style.width = `${size}px`;
            flower.style.height = `${size}px`;
            const startX = Math.random() * window.innerWidth;
            flower.style.left = `${startX}px`;

            // Ch·ªâ d√πng h√¨nh tr√°i tim/hoa m√†u ƒë·ªè h·ªìng
            let svgContent = `<svg viewBox="0 0 30 30" fill="${["#ffb7b2", "#ff9aa2", "#e57373"][Math.floor(Math.random()*3)]}" style="width:100%;height:100%;filter:drop-shadow(0 2px 3px rgba(0,0,0,0.1));"><path d="M15,30 C5,20 0,10 5,5 C8,2 12,5 15,10 C18,5 22,2 25,5 C30,10 25,20 15,30 Z" /></svg>`;

            flower.innerHTML = svgContent;
            document.body.appendChild(flower);

            gsap.to(flower, {
                y: window.innerHeight + 100,
                x: startX + (Math.random() - 0.5) * 200,
                rotation: Math.random() * 360,
                duration: Math.random() * 4 + 4,
                ease: "power1.out",
                onComplete: () => {
                    flower.remove();
                }
            });
        }
        setInterval(createFlower, 400);

        // ===========================================
        // 4. V·∫º TR√ÅI TIM & H·ªòP QU√Ä & PH·ª§ KI·ªÜN M·ªöI
        // ===========================================
        function adjustColor(color, amount) {
            return '#' + color.replace(/^#/, '').replace(/../g, color => ('0' + Math.min(255, Math.max(0, parseInt(color, 16) + amount)).toString(16)).substr(-2));
        }

        // --- H√ÄM V·∫º G·∫§U B√îNG ---
        function drawTeddyBear(ctx, x, y, scale) {
            ctx.save();
            ctx.translate(x, y);
            ctx.scale(scale, scale);

            // Tai
            ctx.fillStyle = "#8d6e63"; // N√¢u ƒë·∫≠m
            ctx.beginPath(); ctx.arc(-25, -50, 12, 0, Math.PI * 2); ctx.fill(); // Tai tr√°i
            ctx.beginPath(); ctx.arc(25, -50, 12, 0, Math.PI * 2); ctx.fill();  // Tai ph·∫£i
            ctx.fillStyle = "#d7ccc8"; // M√†u kem
            ctx.beginPath(); ctx.arc(-25, -50, 7, 0, Math.PI * 2); ctx.fill();
            ctx.beginPath(); ctx.arc(25, -50, 7, 0, Math.PI * 2); ctx.fill();

            // Th√¢n
            ctx.fillStyle = "#8d6e63";
            ctx.beginPath();
            ctx.ellipse(0, 20, 35, 45, 0, 0, Math.PI * 2); // B·ª•ng b·∫ßu
            ctx.fill();
            ctx.fillStyle = "#d7ccc8"; // B·ª•ng s√°ng
            ctx.beginPath();
            ctx.ellipse(0, 20, 20, 28, 0, 0, Math.PI * 2); 
            ctx.fill();

            // Ch√¢n
            ctx.fillStyle = "#8d6e63";
            ctx.beginPath(); ctx.ellipse(-30, 55, 12, 18, -0.5, 0, Math.PI * 2); ctx.fill(); // Ch√¢n tr√°i
            ctx.beginPath(); ctx.ellipse(30, 55, 12, 18, 0.5, 0, Math.PI * 2); ctx.fill();  // Ch√¢n ph·∫£i

            // Tay
            ctx.beginPath(); ctx.ellipse(-35, 0, 12, 20, 0.5, 0, Math.PI * 2); ctx.fill(); // Tay tr√°i
            ctx.beginPath(); ctx.ellipse(35, 0, 12, 20, -0.5, 0, Math.PI * 2); ctx.fill(); // Tay ph·∫£i

            // ƒê·∫ßu
            ctx.fillStyle = "#8d6e63";
            ctx.beginPath();
            ctx.arc(0, -30, 32, 0, Math.PI * 2);
            ctx.fill();

            // M√µm
            ctx.fillStyle = "#d7ccc8";
            ctx.beginPath();
            ctx.ellipse(0, -25, 14, 10, 0, 0, Math.PI * 2);
            ctx.fill();

            // M·∫Øt m≈©i
            ctx.fillStyle = "#3e2723";
            ctx.beginPath(); ctx.arc(-10, -35, 3, 0, Math.PI * 2); ctx.fill(); // M·∫Øt tr√°i
            ctx.beginPath(); ctx.arc(10, -35, 3, 0, Math.PI * 2); ctx.fill();  // M·∫Øt ph·∫£i
            ctx.beginPath(); ctx.ellipse(0, -28, 4, 3, 0, 0, Math.PI * 2); ctx.fill(); // M≈©i

            // N∆° ƒë·ªè
            ctx.fillStyle = "#c0392b";
            ctx.beginPath();
            ctx.moveTo(0, -5);
            ctx.lineTo(-10, -10); ctx.lineTo(-10, 0); ctx.closePath(); ctx.fill();
            ctx.beginPath();
            ctx.moveTo(0, -5);
            ctx.lineTo(10, -10); ctx.lineTo(10, 0); ctx.closePath(); ctx.fill();
            
            // C·∫ßm tim nh·ªè
            ctx.fillStyle = "#e74c3c";
            ctx.beginPath();
            ctx.moveTo(0, 5);
            ctx.bezierCurveTo(0, 0, -10, -5, -10, 5);
            ctx.bezierCurveTo(-10, 15, 0, 20, 0, 25);
            ctx.bezierCurveTo(0, 20, 10, 15, 10, 5);
            ctx.bezierCurveTo(10, -5, 0, 0, 0, 5);
            ctx.fill();

            ctx.restore();
        }

        // --- H√ÄM V·∫º TR√Ä S·ªÆA ---
        function drawBubbleTea(ctx, x, y, scale) {
            ctx.save();
            ctx.translate(x, y);
            ctx.scale(scale, scale);

            // C·ªëc (H√¨nh thang)
            ctx.fillStyle = "#f3e5ab"; // M√†u tr√† s·ªØa
            ctx.beginPath();
            ctx.moveTo(-25, -40);
            ctx.lineTo(25, -40);
            ctx.lineTo(20, 40);
            ctx.bezierCurveTo(20, 50, -20, 50, -20, 40);
            ctx.lineTo(-25, -40);
            ctx.fill();
            
            // Vi·ªÅn c·ªëc
            ctx.strokeStyle = "rgba(0,0,0,0.1)";
            ctx.lineWidth = 1;
            ctx.stroke();

            // Tr√¢n ch√¢u (Topping) - V·∫Ω random ·ªü ƒë√°y
            ctx.fillStyle = "#3e2723"; // ƒêen/N√¢u ƒë·∫≠m
            for(let i=0; i<15; i++) {
                let bx = (Math.random() - 0.5) * 30;
                let by = 20 + Math.random() * 20;
                ctx.beginPath(); ctx.arc(bx, by, 3, 0, Math.PI*2); ctx.fill();
            }

            // Pudding/Th·∫°ch (Topping)
            ctx.fillStyle = "#ffb74d"; // M√†u pudding v√†ng cam
            ctx.fillRect(-15, 10, 10, 10);
            ctx.fillStyle = "#5d4037"; // Th·∫°ch n√¢u
            ctx.fillRect(5, 5, 8, 8);

            // N·∫Øp c·∫ßu
            ctx.fillStyle = "rgba(255, 255, 255, 0.3)";
            ctx.strokeStyle = "#ccc";
            ctx.beginPath();
            ctx.arc(0, -40, 26, Math.PI, 0);
            ctx.fill();
            ctx.stroke();

            // ·ªêng h√∫t
            ctx.fillStyle = "#e91e63"; // H·ªìng ƒë·∫≠m
            ctx.beginPath();
            ctx.rect(-3, -70, 6, 40);
            ctx.fill();
            
            ctx.restore();
        }

        function drawChocolatePiece(ctx, x, y, type) {
            ctx.save();
            ctx.translate(x, y);
            ctx.fillStyle = "#fff5e6";
            ctx.beginPath();
            ctx.arc(0, 0, 11, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = "#e6ccb3";
            ctx.lineWidth = 1;
            ctx.setLineDash([2, 2]);
            ctx.stroke();
            ctx.setLineDash([]);

            if (type === 'dark') {
                let grd = ctx.createRadialGradient(-3, -3, 1, 0, 0, 10);
                grd.addColorStop(0, "#8d6e63");
                grd.addColorStop(1, "#3e2723");
                ctx.fillStyle = grd;
                ctx.beginPath();
                ctx.arc(0, 0, 9, 0, Math.PI * 2);
                ctx.fill();
            } else if (type === 'gold') {
                let grd = ctx.createRadialGradient(-2, -2, 1, 0, 0, 9);
                grd.addColorStop(0, "#fff59d");
                grd.addColorStop(0.5, "#fbc02d");
                grd.addColorStop(1, "#f57f17");
                ctx.fillStyle = grd;
                ctx.beginPath();
                ctx.arc(0, 0, 9, 0, Math.PI * 2);
                ctx.fill();
            } else if (type === 'square') {
                let grd = ctx.createLinearGradient(-5, -5, 5, 5);
                grd.addColorStop(0, "#d7ccc8");
                grd.addColorStop(1, "#795548");
                ctx.fillStyle = grd;
                ctx.fillRect(-7, -7, 14, 14);
            } else if (type === 'heart') {
                ctx.fillStyle = "#f48fb1";
                ctx.beginPath();
                ctx.moveTo(0, 3);
                ctx.bezierCurveTo(0, 1, -6, -5, -6, -8);
                ctx.bezierCurveTo(-6, -11, -3, -11, 0, -8);
                ctx.bezierCurveTo(3, -11, 6, -11, 6, -8);
                ctx.bezierCurveTo(6, -5, 0, 1, 0, 3);
                ctx.fill();
            }
            ctx.restore();
        }

        function drawChocolateBox(ctx, x, y, scale, rotation) {
            ctx.save();
            ctx.translate(x, y);
            ctx.scale(scale, scale);
            ctx.rotate(rotation * Math.PI / 180);
            ctx.shadowColor = "rgba(0,0,0,0.3)";
            ctx.shadowBlur = 15;
            ctx.shadowOffsetY = 10;

            // Box Shape
            ctx.fillStyle = "#922b21";
            ctx.beginPath();
            ctx.moveTo(0, 20);
            ctx.bezierCurveTo(0, 15, -42, -20, -42, -45);
            ctx.bezierCurveTo(-42, -77, 0, -77, 0, -45);
            ctx.bezierCurveTo(0, -77, 42, -77, 42, -45);
            ctx.bezierCurveTo(42, -20, 0, 15, 0, 20);
            ctx.fill();

            // Inner
            ctx.shadowColor = "transparent";
            ctx.fillStyle = "#3E0E0E";
            ctx.beginPath();
            ctx.moveTo(0, 16);
            ctx.bezierCurveTo(0, 12, -38, -20, -38, -45);
            ctx.bezierCurveTo(-38, -73, -2, -73, 0, -48);
            ctx.bezierCurveTo(2, -73, 38, -73, 38, -45);
            ctx.bezierCurveTo(38, -20, 0, 12, 0, 16);
            ctx.fill();
            ctx.strokeStyle = "#F1C40F";
            ctx.lineWidth = 1;
            ctx.stroke();

            // Pieces
            drawChocolatePiece(ctx, -20, -50, 'dark');
            drawChocolatePiece(ctx, 20, -50, 'square');
            drawChocolatePiece(ctx, 0, -35, 'gold');
            drawChocolatePiece(ctx, -12, -20, 'square');
            drawChocolatePiece(ctx, 12, -20, 'dark');
            drawChocolatePiece(ctx, 0, -5, 'heart');
            ctx.restore();
        }

        // --- H√ÄM V·∫º B√ì HOA H·ªíNG CHI TI·∫æT ---
        function drawRealisticBouquet(ctx, x, y, scale, rotation) {
            ctx.save();
            ctx.translate(x, y);
            ctx.scale(scale, scale);
            ctx.rotate(rotation * Math.PI / 180);

            // Gi·∫•y g√≥i
            ctx.fillStyle = "#1a1a1a";
            ctx.beginPath(); ctx.moveTo(0, 110); ctx.lineTo(-70, -50); ctx.lineTo(70, -50); ctx.closePath(); ctx.fill();
            ctx.fillStyle = "#222222";
            ctx.beginPath(); ctx.moveTo(0, 100); ctx.lineTo(-60, -40); ctx.lineTo(30, -45); ctx.closePath(); ctx.fill();
            ctx.fillStyle = "#2c2c2c";
            ctx.beginPath(); ctx.moveTo(0, 100); ctx.lineTo(-45, -35); ctx.lineTo(45, -35); ctx.closePath(); ctx.fill();

            // N·∫øp g·∫•p & Ruy bƒÉng
            ctx.strokeStyle = "#000000"; ctx.lineWidth = 0.5;
            ctx.beginPath(); ctx.moveTo(0, 100); ctx.lineTo(-30, 10); ctx.moveTo(0, 100); ctx.lineTo(30, 20); ctx.stroke();
            ctx.fillStyle = "#f0f0f0"; ctx.fillRect(-18, 65, 36, 5);

            // L√° c√¢y
            const leafColors = ["#2d5a27", "#3e7a37", "#1e3c1a"];
            for (let i = 0; i < 20; i++) {
                ctx.fillStyle = leafColors[Math.floor(Math.random() * leafColors.length)];
                ctx.beginPath();
                let lX, lY, r;
                if (i % 2 === 0) { lX = -(40 + Math.random() * 30); lY = -35 - Math.random() * 30; r = -Math.PI / 3; }
                else { lX = (40 + Math.random() * 30); lY = -35 - Math.random() * 30; r = Math.PI / 3; }
                ctx.ellipse(lX, lY, 4, 8, r, 0, Math.PI * 2);
                ctx.fill();
            }

            // Hoa h·ªìng chi ti·∫øt
            const baseFlowerColors = ["#ff0055", "#ff3377", "#e6004c", "#ff6699", "#ff1a66"];
            for (let i = 0; i < 100; i++) {
                const baseColor = baseFlowerColors[Math.floor(Math.random() * baseFlowerColors.length)];
                const centerColor = adjustColor(baseColor, -60);
                const angle = Math.random() * Math.PI * 2;
                const r = Math.sqrt(Math.random()) * 45;
                const fX = Math.cos(angle) * r;
                const fY = Math.sin(angle) * r * 0.8 - 45;
                const size = 7 + Math.random() * 5;
                
                // N·ªÅn hoa
                const grd = ctx.createRadialGradient(fX, fY, size * 0.1, fX, fY, size);
                grd.addColorStop(0, centerColor);
                grd.addColorStop(0.7, baseColor);
                ctx.fillStyle = grd;
                ctx.beginPath(); ctx.arc(fX, fY, size, 0, Math.PI * 2); ctx.fill();

                // C√°nh hoa xo·∫Øn ·ªëc chi ti·∫øt
                ctx.strokeStyle = adjustColor(baseColor, 30);
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.arc(fX, fY, size * 0.4, 0.5, Math.PI * 1.2);
                ctx.stroke();
                ctx.beginPath();
                ctx.arc(fX + 1, fY + 1, size * 0.6, 2.5, Math.PI * 0.8);
                ctx.stroke();
                ctx.beginPath();
                ctx.arc(fX - 1, fY - 1, size * 0.3, 4, Math.PI * 2);
                ctx.stroke();
            }
            ctx.restore();
        }

        function initHeartAnimation() {
            const giftBox = document.getElementById('giftBox');
            const heartCanvas = document.getElementById('heartCanvas');
            const giftText = document.getElementById('giftText');
            const finalMsg = document.getElementById('final-msg-container');

            giftBox.onclick = () => {
                giftBox.classList.add('opening');
                giftText.innerText = "ƒêang m·ªü qu√†...";
                
                setTimeout(() => {
                    giftBox.classList.add('hidden');
                    // ·∫®n d√≤ng ch·ªØ h∆∞·ªõng d·∫´n
                    giftText.style.opacity = '0';
                    setTimeout(() => giftText.style.display = 'none', 500);

                    heartCanvas.classList.remove('hidden');
                    const ctx = heartCanvas.getContext('2d');

                    // --- V·∫º C√ÅC M√ìN QU√Ä ---
                    
                    // 1. G·∫•u b√¥ng 
                    drawTeddyBear(ctx, 60, 300, 1.2);

                    // 2. Tr√† s·ªØa 
                    drawBubbleTea(ctx, 740, 300, 1.3);

                    // 3. B√≥ hoa 
                    drawRealisticBouquet(ctx, 170, 260, 1.0, -15); // B√™n tr√°i
                    drawRealisticBouquet(ctx, 630, 260, 1.0, 15);  // B√™n ph·∫£i

                    // 4. H·ªôp socola 
                    drawChocolateBox(ctx, 160, 140, 1.4, -15);
                    drawChocolateBox(ctx, 640, 140, 1.4, 15);

                    let t = 0;
                    // Hi·ªáu ·ª©ng v·∫Ω tr√°i tim ·ªü gi·ªØa
                    function draw() {
                        if (t > 2 * Math.PI) {
                            // Khi v·∫Ω xong, hi·ªán th√¥ng ƒëi·ªáp cu·ªëi c√πng
                            finalMsg.style.display = 'flex';
                            setTimeout(() => { finalMsg.style.opacity = 1; }, 100);
                            return;
                        }
                        const scale = 12;
                        const x = 16 * Math.pow(Math.sin(t), 3);
                        const y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
                        ctx.fillStyle = "#c0392b";
                        ctx.beginPath();
                        ctx.arc(x * scale + 400, y * scale + 180, 4, 0, Math.PI * 2);
                        ctx.fill();
                        t += 0.05;
                        setTimeout(function() {
                            requestAnimationFrame(draw);
                        }, 15);
                    }
                    draw();
                }, 1200);
            };
        }
    </script>
</body>
</html>
